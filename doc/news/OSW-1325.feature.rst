Refactor repeated table code and implement URL based filtering

